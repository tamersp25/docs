<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Veritone Docs</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="description" content="Veritone Docs">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <link rel="apple-touch-icon"
    sizes="180x180"
    href="https://static.veritone.com/assets/favicon/apple-touch-icon.png?v=lkgpRBRLYl"
  >
  <link rel="icon"
    type="image/png"
    href="https://static.veritone.com/assets/favicon/favicon-32x32.png?v=lkgpRBRLYl"
    sizes="32x32"
  >
  <link rel="icon"
    type="image/png"
    href="https://static.veritone.com/assets/favicon/favicon-16x16.png?v=lkgpRBRLYl"
    sizes="16x16"
  >
  <link rel="mask-icon"
    href="https://static.veritone.com/assets/favicon/safari-pinned-tab.svg?v=lkgpRBRLYl"
    color="#597cb1"
  >
  <link rel="shortcut icon"
    href="https://static.veritone.com/assets/favicon/favicon.ico"
    type="image/x-icon"
  >

  <!--Themes-->
  <link rel="stylesheet" href="//unpkg.com/docsify/lib/themes/vue.css">

  <link href="https://fonts.googleapis.com/css?family=Dosis&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Nunito&display=swap" rel="stylesheet">

  <!--Custom Veritone CSS-->
  <style>

    /* For collapsing all but current page */
    .sidebar-nav .collapse ul {
      display: none;
    }

    /**
     * For highlighting the currently selected page
     * Because the default assumes you only want things highlighted if they don't have any subpages
     **/
    .sidebar-nav .active > a {
      border-right: 2px solid;
      /*noinspection CssUnresolvedCustomProperty*/
      color: var(--theme-color,#42b983);
      font-weight: 600;
    }

    /* Provide some differentiation between section headings and sub-pages in the sidebar */
    /*noinspection CssUnusedSymbol*/
    .sidebar-nav .section-link {
      font-style: italic;
    }

    /* Make the top-level headings stand out in the nav bar */
    .sidebar-nav > ul > li > p > a, .sidebar-nav > ul > li > a {
      font-weight: 600;
      font-size: 17px;
      margin-top: 20px;
      border-top: 1px #eee solid;
    }

    /* Style the "Try in GraphiQL" link */
    pre[data-lang="graphql"] {
      margin-bottom: .25em;
    }
    p.graphql-link {
      text-align: right;
      margin-top: .25em;
      padding-right: 1em;
    }
    p.graphql-link a img {
      position: relative;
      top: 3px;
    }

    body {
      font-family: 'Nunito', sans-serif;
      font-size: 14px;
    }

    section.cover.show {
      display: block;
      overflow-y: scroll;
    }

    section.cover.show .cover-main {
      margin: 0;
      padding-top: 100px;
    }

    .cover .main {
      margin-left: 20px;
      margin-right: 20px;
    }

    .cover h1 {
      font-family: 'Dosis', sans-serif;
      font-weight: 600;
      font-size: 50px;
      text-transform: uppercase;
    }

    .cover h2 {
      text-transform: uppercase;
    }

    .cover .subtitle {
      font-family: 'Dosis', sans-serif;
      font-weight: 600;
      font-size: 25px;
      text-transform: uppercase;
    }

    .cover .card {
      background-color: #FFFFFF;
      margin: 20px auto;
      padding-top: 10px;
      padding-bottom: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);  /* TODO: Tune this or use someone else's "card" */
    }

    .cover .personas-container {
      display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      justify-content: center;
    }

    .cover .personas-container .card {
      width: 300px;
    }

    .cover .platform-approach {
      color: white;
      background-color: blue; /* TODO: fix this color */
      height: 500px; /* TODO: Temporary hack to see how overflow scrolling works.  Fill with content instead */
    }

    .markdown-section h1 {
      font-weight: bold;
      font-size: 32px;
      color: #132d43;
    }

    .markdown-section h2 {
      font-weight: bold;
      font-size: 25px;
    }

    .markdown-section h3 {
      font-size: 16px;
    }

    .markdown-section h4 {
      font-size: 14px;
      font-style: italic;
    }

    .markdown-section h5 {
      font-size: 12px;
    }

    .markdown-section h6 {
      font-size: 12px;
      font-style: italic;
    }

  </style>
</head>
<body>
  <nav>
    <a href="https://chat.veritone.com/" target="_blank">
      <!--suppress HtmlUnknownTarget -->
      <img src="/_media/slack.svg" style="margin-right: 5px" alt="Slack logo"/>
      Join us on Slack
    </a>
    <a id="new-issue-link" href="javascript:void(0)">
      <!--suppress HtmlUnknownTarget -->
      <img src="/_media/github.png" style="width:16px; margin-right: 5px" alt="GitHub logo"/>
      File an Issue
    </a>
  </nav>
  <div id="app"></div>
  <!-- <script src="//unpkg.com/docsify-copy-code/index.js"></script> -->
  <script>
    window.$docsify = {
      search: 'auto', // default
      maxLevel: 1,
      name: '<div><img src="https://static.veritone.com/assets/favicon/favicon.ico" height="18px" width="18px" style="margin-right: 5px"  alt="Veritone logo"/> Veritone Docs</div>',
      repo: '',
      // routerMode: 'history',
      subMaxLevel: 2,
      loadSidebar: true,
      auto2top: true,
      coverpage: true,
      // notFoundPage: {
      //   '\/(.*)(?<!\/)$': '1$/'
      // }

      /**
       * WARNING: Overridden Docsify behavior!
       *
       * Docsify uses aliases to dynamically use the content of one page to render on another URL.
       * This keeps the requested URL in the window location href but renders the content of another page.
       * This WORKS but it has problems with relative references, sidebar active page, and stuff.
       * Plus it keeps those legacy page URLs around and encourages their use.
       *
       * With our veritoneAliasRedirect plugin below, the alias is still used to resolve the page and load the markdown.
       * But then AFTER the page is resolved, our plugin runs and if it senses an alias was needed, it does a hard
       * reload to the alias destination.
       * This helps us encourage use of the canonical URLs and resolve relative assets and stuff nicely.
       */
      alias: {
        // Ensures there's only ever one single sidebar
        '/.*/_sidebar.md': '/_sidebar.md',

        // Permalinks for deprecated sections
        '^\/apis\/job-quick-start-guide.*$': '/apis/job-quickstart/',
        '^\/apis\/search-quick-start-guide.*$': '/apis/search-quickstart/',

        // Maintaining permalinks from old engines section
        '^\/engines\/classes$': '/developer/engines/cognitive/',
        // TODO: It'd be nice to port over some of the quick-start pages that still apply though.  All those screenshots and stuff...
        '^(\/developer|)\/engines\/quick-start(.*)': '/developer/engines/getting-started/',
        '^\/engines\/types$': '/developer/engines/',
        '^\/engines\/guidelines\/?$': '/developer/engines/',
        '^\/engines\/guidelines\/cognitive-engines$': '/developer/engines/cognitive/',
        '^\/engines\/guidelines\/real-time-engines$': '/developer/engines/cognitive/',
        // TODO: Adapters section might be out of date
        '^\/engines\/guidelines\/adapters$': '/developer/adapters/guidelines',
        '^\/engines\/engine_standards\/?$': '/developer/engines/standards/engine-output/',
        '^\/engines\/engine_standards\/capability\/?': '/developer/engines/cognitive/',
        '^\/engines\/engine_standards\/veri_standards$': '/developer/engines/standards/engine-output/',
        '^\/engines\/manifest\/?$': '/developer/engines/standards/engine-manifest/',
        '^\/engines\/custom-fields$': '/developer/engines/custom-fields/',
        '^\/engines\/testing-and-debugging$': '/developer/engines/testing-and-debugging/',
        '^\/engines\/engine-input-output\/$': '/developer/engines/cognitive/',
        '^\/engines\/engine-input-output\/transcription$': '/developer/engines/cognitive/speech/transcription/',
        '^\/engines\/engine-input-output\/object-detection$': '/developer/engines/cognitive/vision/object-detection/',
        '^\/engines\/engine-input-output\/face-detection$': '/developer/engines/cognitive/biometrics/face-detection/',
        '^\/engines\/faq$': '/developer/engines/faq/',

        // Permalinks to support legacy developer-only file structure
        '^\/applications(|/.*)$': '/developer/applications$1',
        '^\/data/(|/.*)$': '/developer/data$1',
        '^\/engines(|/.*)$': '/developer/engines$1',
        '^\/libraries(|/.*)$': '/developer/libraries$1',
        '^\/veritone-developer-overview(|.md)$': '/developer/',
        '^\/developer-benefits(|.md)$': '/developer/benefits',
        '^\/terms-and-conditions(|.md)$': '/developer/terms-and-conditions',

        // Makes trailing slash optional for certain pages
        // TODO: change convention to use README files for all content pages (no my-page-name.md, only my-page-name/README.md)
        // and add a global alias (or maybe just a hard redirect in the plugin for converting no-trailing-slash to trailing-slash
        '^\/architecture-overview(|.md)$': '/architecture-overview/',
        '^\/glossary(|.md)': '/glossary/',
        '^\/apis$': '/apis/',
        '^\/apis\/job-quickstart(|.md)$': '/apis/job-quickstart/',
        '^\/apis\/search-quickstart(|.md)$': '/apis/search-quickstart/',
        '^\/apis\/tutorials$': '/apis/tutorials/',
        '^\/developer\/applications$': '/developer/applications/',
        '^\/developer\/data$': '/developer/data/',
        '^\/developer\/engines$': '/developer/engines/',
        '^\/developer/libraries$': '/developer/libraries/',
        '^\/engines\/engine-input-output$': '/engines/engine-input-output/',
        '^\/engines\/tutorials$': '/engines/tutorials/',
        '(.*)\/quick-start$': '$1/quick-start/',
      }
    };
    document.getElementById('new-issue-link').addEventListener('click', function() {
      window.open('https://github.com/veritone/docs/issues/new?title=' + encodeURIComponent('Issue on page: ' + (document.location.hash.slice(2) || 'Home')));
    });
  </script>
  <script src="//unpkg.com/docsify/lib/docsify.min.js"></script>
  <script src="//unpkg.com/docsify/lib/plugins/search.min.js"></script>
  <script src="//unpkg.com/prismjs/components/prism-bash.min.js"></script>
  <script src="//unpkg.com/prismjs/components/prism-graphql.min.js"></script>
  <script src="//unpkg.com/prismjs/components/prism-python.min.js"></script>
  <script src="//unpkg.com/prismjs/components/prism-json.min.js"></script>
  <script src="//unpkg.com/prismjs/components/prism-http.min.js"></script>

  <!--Custom script to collapse all other sidebar links besides active page-->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>
    var RECURSION_LIMIT = 50;
    var collapseNavElRecursion = 0;
    var collapseExtendedFamilyRecursion = 0;

    window.VERITONE_CONFIG = {
      apiRoot: "@@apiRoot@@"
    };

    // Custom docsify plugins
    window.$docsify.plugins = [

      /**
       * Sidebar Collapse
       * Makes all elements of the sidebar that aren't directly around the current node collapse
       * Leaves only the parent hierarchy leading to the current node and the first-level children of the current node expanded.
       **/
      function veritoneSidebarCollapsePlugin(hook) {
        hook.doneEach(function onPageChanged() {
          collapseExtendedFamilyRecursion = 0;
          var activeEl = $('.sidebar-nav .active');
          collapseChildren(activeEl);
          collapseExtendedFamily(activeEl);
        });
      },

      /**
       * Overrides Doscify "alias" behavior to also redirect whenever an alias was used to resolve a page
       * Does not apply to other assets like the sidebar alias (I think)
       **/
      function veritoneAliasRedirectPlugin(hook, vm) {
        hook.beforeEach(function onBeforePageParsed() {
          var redirects = vm.router.config.alias;
          iterateObject(redirects, function (routeMatch, newRoute) {
            var routeMatchRegex = new RegExp(routeMatch, 'g');
            var testResult = routeMatchRegex.exec(vm.route.path);
            if (testResult) {
              for (var i = 1; i < testResult.length; i++) {
                newRoute = newRoute.replace('$' + i, testResult[i]);
              }
              console.log('Alias detected.  Redirecting from ' + vm.route.path + ' to ' + newRoute);
              window.location.replace(window.location.origin + window.location.pathname + '#' + newRoute);
              return true;
            }
          });
        });
      },

      /**
       * "Support" Badges
       * Replaces instances of `[badge/API/Yes/green]` with a badge from shields.io
       * with a label of "API Support", a value of "Yes", and a color of green.
       **/
      function veritoneBadgePlugin(hook) {
        hook.beforeEach(function onBeforePageParsed(content) {
          var BADGE_REGEX = /\[badge\/(\w+)\/(\w+)\/(\w+)]/g;
          // TODO: Wrap with link to explanations of what API, Search, and UI Support mean
          return content.replace(BADGE_REGEX, '![$1 Support: $2](https://img.shields.io/badge/$1%20Support-$2-$3.svg)');
        });
      },

      /**
       * Adds a "Try It" link to any GraphQL samples
       **/
      function veritoneGraphqlLinkPlugin(hook) {
        hook.doneEach(function onPageChanged() {
          var examples = $('[data-lang="graphql"]');
          for (var i = 0; i < examples.length; i++) {
            try {
              createLinkFromExample(examples[i], "Try it in GraphiQL").insertAfter(examples[i]);
            } catch (e) {
              console.error(`Error adding GraphiQL link: ${e}`);
            }
          }
        });

        function createLinkFromExample(exampleNode, text) {
          var url = `${VERITONE_CONFIG.apiRoot}/v3/graphiql?query=${encodeURIComponent(exampleNode.innerText)}`;
          return $(`
            <p class="graphql-link">
              <a href="${url}" target="_blank">
                <img src="_media/graphql.svg" height="16px" width="16px" alt="GraphQL icon">
                ${text}
              </a>
            </p>`
          );
        }


      }
    ].concat(window.$docsify.plugins || []);


    function collapseChildren(el) {
      el = getSidebarNode(el);
      var subNavEls = getChildren(el);
      for (var i = 0; i < subNavEls.length; i++) {
        collapseNavEl($(subNavEls[i]));
      }
    }

    /**
     * Collapses all sidebar elements that are cousins (1st, 2nd, whatever) of the element
     **/
    function collapseExtendedFamily(el) {
      el = getSidebarNode(el);
      collapseExtendedFamilyRecursion++;
      if (collapseExtendedFamilyRecursion > RECURSION_LIMIT) {
        console.error('collapseExtendedFamily recursion limit reached!');
        return;
      }
      var siblings = el.siblings();
      for (var i = 0; i < siblings.length; i++) {
        var sibling = $(siblings[i]);
        collapseNavElRecursion = 0;
        collapseNavEl(sibling);
      }
      var parentEl = el.parent().parent();  // li > ul > li
      if (!el.hasClass('sidebar-nav')) {
        collapseExtendedFamily(parentEl);
      }
      // TODO: It's currently recursing out of .sidebar-nav.  We should stop that once it gets to that point.
    }

    /**
     * Collapses the first level of the nav el that has links
     * Prevents us from collapsing a nav el that can't be expanded
     * @param el
     */
    function collapseNavEl(el) {
      collapseNavElRecursion++;
      if (collapseNavElRecursion > RECURSION_LIMIT) {
        console.error('collapseNavEl recursion limit reached!');
        return;
      }
      if (el.children().length === 0) {
        // No children. Don't try to collapse.
      } else if (el.children()[0].tagName.toLowerCase() === 'a') {
        // Non-top-level link.  Collapse it.
        el.addClass('collapse');
      } else if (el.children()[0].tagName.toLowerCase() === 'p' &&
        $(el.children()[0]).children().length > 0 &&
        $(el.children()[0]).children()[0].tagName.toLowerCase() === 'a') {
        // Top-level link.  Collapse it.
        el.addClass('collapse');
      } else if (el.find('ul a').length) {
        // It's not a link but there's one in its children somewhere.  Go find it.
        collapseChildren(el);
      }
    }

    /**
     * @todo: Kinda poorly assumes el.children[1] is ul
     **/
    function getChildren(el) {
      return $(el.children()[1]).children();
    }

    /**
     * Returns the correct sidebar element to collapse based off of
     * The top level of the sidebar only sets .active on a child <p> so we need to go up to the
     * @param el
     */
    function getSidebarNode(el) {
      if (el[0].tagName.toLowerCase() === 'p' && el.hasClass('active')) {
        return el.parent();
      }
      return el;
    }

    /**
     * Iterates over an object and calls the callback with the key and value
     * If the callback returns a truthy value, the iteration will be stopped
     * @param obj An object to iterate over
     * @param callback Callback function that accepts the key as the first parameter and the value as the second
     */
    function iterateObject(obj, callback) {
      for (var key in obj) {
        if (obj.hasOwnProperty(key)) {
          var stop = callback(key, obj[key]);
          if (stop) {
            break;
          }
        }
      }
    }
  </script>
</body>
</html>
